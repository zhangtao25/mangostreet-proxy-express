(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{101:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"add"}},[a("div",{staticClass:"row"},[a("span",{on:{click:function(t){return e.goTo("/home")}}},[e._v("取消")]),e._v(" "),a("span",{on:{click:e.onSubmit}},[e._v("确定")])]),e._v(" "),a("div",{staticClass:"row"},[a("md-field",[a("md-input-item",{attrs:{placeholder:"请输入标题"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),e._v(" "),a("md-field",[a("md-textarea-item",{ref:"demo2",staticClass:"demo2",attrs:{autosize:!0,"max-length":100,"max-height":150,placeholder:"描述信息在100字以内"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("template",{slot:"footer"},[a("p",{staticClass:"demo2-footer"},[e.value.length?a("span",{staticClass:"demo2-footer-left"},[e._v(e._s(e.value.length)+"/100")]):e._e()])])],2)],1)],1),e._v(" "),a("div",{staticClass:"row"},[a("image-reader",{ref:"imageReader",on:{giveData:e.giveData}})],1),e._v(" "),a("div",{staticClass:"row"},[a("md-field",[a("md-cell-item",{class:{selected:null!==e.locateAddress},attrs:{title:null===e.locateAddress?"所选地址":e.locateAddress,arrow:""},on:{click:e.fn}},[a("div",{staticClass:"icon",attrs:{slot:"left"},slot:"left"},[a("md-icon",{attrs:{name:"location"}})],1)])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowLocationSelector,expression:"isShowLocationSelector"}],staticClass:"location-selector"},[a("iframe",{attrs:{id:"location-selector-iframe",src:"https://m.amap.com/picker/?center="+e.currentLocation+"&key=b377f3b0be063e4ee2b2b8d40afae0d7"}})])])};n._withStripped=!0;var i=a(11),o=a.n(i),r=a(12),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"md-example-child md-example-child-reader md-example-child-reader-0"},[a("ul",{staticClass:"image-reader-list"},[e._l(e.imageList.reader0,(function(t,n){return a("li",{key:n,staticClass:"image-reader-item",style:{backgroundImage:"url(http://mangostreet.top:8001/note/"+t+")"}},[a("md-tag",{staticClass:"image-reader-item-del",attrs:{size:"small",shape:"quarter","fill-color":"#111A34",type:"fill","font-color":"#fff"},nativeOn:{click:function(t){return e.onDeleteImage("reader0",n)}}},[a("md-icon",{attrs:{name:"close"}})],1)],1)})),e._v(" "),a("li",{staticClass:"image-reader-item add"},[a("md-image-reader",{attrs:{name:"reader0",amount:e.amount-e.imageList.reader0.length==0?-1:e.amount-e.imageList.reader0.length,"is-multiple":""},on:{select:e.onReaderSelect,complete:e.onReaderComplete,error:e.onReaderError}}),e._v(" "),a("md-icon",{attrs:{name:"camera",size:"md",color:"#CCC"}}),e._v(" "),a("p",[e._v("添加图片")])],1)],2)])};d._withStripped=!0;var c,l=a(36),s={name:"image-reader-demo",components:(c={},o()(c,r.b.name,r.b),o()(c,r.c.name,r.c),o()(c,r.e.name,r.e),c),data:function(){return{imageList:{reader0:[]},amount:9}},methods:{onReaderSelect:function(e,t){var a=this;t.files.forEach((function(e){console.log("[Mand Mobile] ImageReader Selected:","File Name "+e.name),l.a.upload(e).then((function(e){a.imageList.reader0.push(e.data.urls),a.$emit("giveData",a.imageList.reader0)}))})),r.g.loading("图片读取中...")},onReaderComplete:function(e,t){r.g.hide()},onReaderError:function(e,t){console.log(t),"103"===t.code&&r.g.failed("图片超出限制")},onDeleteImage:function(e,t){this.imageList.reader0.splice(t,1),this.$emit("giveData",this.imageList.reader0)}}},m=(a(87),a(4)),u=Object(m.a)(s,d,[],!1,null,"71acac78",null);u.options.__file="src/view/add/image-reader.vue";var p,f=u.exports,g={data:function(){return{title:"",value:"",isShowLocationSelector:!1,locateAddress:null,currentLocation:"0,0",images:""}},components:(p={},o()(p,r.f.name,r.f),o()(p,r.a.name,r.a),o()(p,r.b.name,r.b),o()(p,r.d.name,r.d),o()(p,"image-reader",f),p),methods:{fn:function(){this.isShowLocationSelector=!0},goTo:function(e){this.$router.push({path:e})},onSubmit:function(){var e={title:this.title,content:this.value,contentType:"normal",images:this.images};l.a.createNote(e).then((function(e){console.log(e)}))},giveData:function(e){this.images=e.join(";")},initLocationSelector:function(){var e=this,t=document.getElementById("location-selector-iframe").contentWindow;document.getElementById("location-selector-iframe").onload=function(){t.postMessage("hello","https://m.amap.com/picker/")},window.addEventListener("message",(function(t){t.data.name&&t.data.location&&(e.locateAddress=t.data.name,e.isShowLocationSelector=!1)}),!1),(new AMap.CitySearch).getLocalCity((function(t,a){if("complete"===t&&"OK"===a.info&&a&&a.city&&a.bounds){a.city;var n=a.bounds;e.currentLocation=n.getCenter().M+","+n.getCenter().O}}))}},mounted:function(){this.initLocationSelector()}},h=(a(89),Object(m.a)(g,n,[],!1,null,null,null));h.options.__file="src/view/add.vue";t.default=h.exports},36:function(e,t,a){"use strict";var n=a(37),i=a.n(n);i.a.interceptors.request.use((function(e){e.headers.post["Content-Type"]="application/x-www-form-urlencoded";var t=localStorage.getItem("token");return t&&(e.headers.common["X-User-Token"]=t),e}),(function(e){return Promise.reject(e)})),t.a={getNote:function(){return new Promise((function(e,t){i.a.get("/api/notes",{}).then((function(t){e(t.data)}))}))},createNote:function(e){return new Promise((function(t,a){i.a.post("/api/note/create",function(e){var t=new FormData;for(var a in e)t.append(a,e[a]);return t}(e)).then((function(e){t(e.data)}))}))},upload:function(e){var t=new FormData;return t.append("image",e,e.name),new Promise((function(e,a){i.a.post("/api/upload",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){e(t.data)}))}))}}},42:function(e,t,a){var n=a(88);"string"==typeof n&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};a(2)(n,i);n.locals&&(e.exports=n.locals)},43:function(e,t,a){var n=a(90);"string"==typeof n&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};a(2)(n,i);n.locals&&(e.exports=n.locals)},87:function(e,t,a){"use strict";var n=a(42);a.n(n).a},88:function(e,t,a){(e.exports=a(1)(!1)).push([e.i,".md-example-child-reader .image-reader-list[data-v-71acac78] {\n  float: left;\n  width: 100%;\n}\n.md-example-child-reader .image-reader-list .image-reader-item[data-v-71acac78] {\n  backgroundPosition: center center;\n  backgroundRepeat: no-repeat;\n  backgroundSize: cover;\n  position: relative;\n  float: left;\n  width: 31%;\n  padding-bottom: 31%;\n  margin-bottom: 2%;\n  margin-right: 2%;\n  background: #fff;\n  box-shadow: 0 0.05rem 0.2rem rgba(197,202,213,0.25);\n  box-sizing: border-box;\n  list-style: none;\n  border-radius: 0.04rem;\n  background-size: cover;\n  overflow: hidden;\n}\n.md-example-child-reader .image-reader-list .image-reader-item[data-v-71acac78]:nth-of-type(4n) {\n  margin-right: 0;\n}\n.md-example-child-reader .image-reader-list .image-reader-item.add .md-icon[data-v-71acac78] {\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  opacity: 0.5;\n}\n.md-example-child-reader .image-reader-list .image-reader-item.add p[data-v-71acac78] {\n  position: absolute;\n  top: 50%;\n  left: 0;\n  width: 100%;\n  margin-top: 0.15rem;\n  font-size: 0.22rem;\n  color: #ccc;\n  text-align: center;\n}\n.md-example-child-reader .image-reader-list .image-reader-item .image-reader-item-del[data-v-71acac78] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 3;\n  opacity: 0.8;\n}\n.md-example-child-reader .image-reader-list .image-reader-item .image-reader-item-del .md-icon-close[data-v-71acac78] {\n  font-size: 0.24rem;\n}\n",""])},89:function(e,t,a){"use strict";var n=a(43);a.n(n).a},90:function(e,t,a){(e.exports=a(1)(!1)).push([e.i,"#add .location-selector{top:0;left:0;position:absolute;background-color:white;height:100%;width:100%;z-index:1000}#add iframe{width:100%;height:100%;border:none}#add .row:nth-child(1){display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;padding:0.3rem}#add .row:nth-child(1) span{line-height:0.67rem;text-align:center;border-radius:0.05rem}#add .row:nth-child(1) span:nth-child(2){color:white;width:1.15rem;background-color:#ff5257}#add .row:nth-child(3){padding:0 0.7rem}#add .row:nth-child(4){padding:0 0.7rem}#add .row:nth-child(4) .selected .icon,#add .row:nth-child(4) .selected p{color:#ff5257}\n",""])}}]);